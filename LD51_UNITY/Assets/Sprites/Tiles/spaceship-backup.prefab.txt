using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class EnemyMovement : MonoBehaviour
{
    public Animator animator;
    public Rigidbody2D rb;
    public Transform groundCheckPos;
    public LayerMask groundLayer;
    public Collider2D bodyCollider;
    
	
	public float walkSpeed;
	public Vector2 patrolDirection;
    private float timeElapsed = 0f;



    [HideInInspector]
    public bool mustPatrol;
    private bool mustTurn;
    

    // Start is called before the first frame update
    void Start()
    {
        mustPatrol = true;  
    }

    // Update is called once per frame
    void Update()
    {
        if (mustPatrol)
        {
            Patrol();
        }    
    }
    private void FixedUpdate()
    {
        if (mustPatrol)
        {
            
            mustTurn = !Physics2D.OverlapCircle(groundCheckPos.position, 0.1f, groundLayer);

        } 
        
    }


    void Patrol()
    {     
		if (mustTurn)
        {
            timeElapsed += Time.deltaTime;
            walkSpeed = 0;
            if (timeElapsed >= 4f)
            {
                walkSpeed = 100;
                Flip();
              


            }
            timeElapsed = 0;

        }



        if (bodyCollider.IsTouchingLayers(groundLayer))
        {

            walkSpeed = 0;
        }
        
        rb.velocity = new Vector2(walkSpeed * Time.fixedDeltaTime, rb.velocity.y);
        animator.SetFloat("Speed", Mathf.Abs(walkSpeed));

    }

    void Flip()
    {
        transform.localScale = new Vector2(transform.localScale.x * -1, transform.localScale.y);
        walkSpeed *= -1;
    }


    
}
